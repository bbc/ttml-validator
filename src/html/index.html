<!doctype html>
<html lang="en-gb">
    <head>
        <meta charset="utf-8">
        <title>BBC EBU-TT-D Validator</title>
        <meta name="description" content="Page for checking conformance of a subtitle file with the BBC Subtitle Guidelines">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="icon" href="favicon.ico" />
        <!-- <link rel="apple-touch-icon" href="apple-touch-icon.png"> -->

        <link rel="stylesheet" href="main.css">
        <link rel="stylesheet" type="text/css" href="https://gel.files.bbci.co.uk/r2.512/bbc-reith.css"/>

        <link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/themes/smoothness/jquery-ui.css">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.1/jquery.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
        <!-- This script tag bootstraps PyScript -->
        <script type="module" src="https://pyscript.net/releases/2025.7.3/core.js"></script>
        <!-- <script type="module" src="/pyscript/core.js"></script> -->
        <script src="main.js"></script>
    </head>
    <body>
        <!--[if lt IE 9]>
            <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
        <![endif]-->

        <div id="main">

            <section id="intro">
                <h2>BBC Subtitle Validator</h2>

            </section>

            <section id="upload">
                <p>Choose an EBU-TT-D subtitle document from your computer.
                    The document will be validated by your browser and the results
                    shown in the area below.
                    The file will not be sent to the server.</p>
                <p>The conformance rules are defined by the
                    <a href="https://www.bbc.co.uk/accessibility/forproducts/guides/subtitles/">BBC Subtitle Guidelines</a>.
                </p>
                <input type="file" id="file-input" style="width:512px" multiple/>
                <p>
                    <span>Current file: </span><span id="current-file"></span>
                </p>
            </section>

            <section>
                <h3>File contents:</h3>
                <pre><code id="file-contents"></code></pre>
                <p id="python-signal">X</p>
            </section>

            <button id="validate-button" py-click="validateNow">Validate</button>

            <!-- <script type="py" src="pageScript.py" config="./pyscript.toml"></script> -->
        </div>
        <!-- <script type="py" src="./pageScript.py" config="./pyscript.toml"></script> -->
         <!-- <py-config>
        {
            "packages": ["xmlschema"],
            "files": {
                './ttml_validator-0.1.0.tar.gz' = 'ttmlValidator'
            }
        }
        </py-config> -->

        <script type="py">
from pyscript import document, when, display, window
# from pyweb import pydom


document.querySelector("#python-signal").innerText="pageScript.py"
# pydom["p#python-signal"].html = "pageScript.py"

@when("change", "#file-contents")
def file_change_handler(event):
    display("file contents changed")
    document.querySelector("#python-signal").innerText="file_change_handler"


# @when("click", "#validate-button")
def validateNow(event):
    display("button clicked")
    window.console.log("button clicked")
    document.querySelector("#python-signal").innerText="validateNow"


when('click', '#validate-button', handler=validateNow)
        </script>
    </body>
</html>
